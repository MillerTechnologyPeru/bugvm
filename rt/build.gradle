buildscript {
     repositories {
          jcenter()
     }
     dependencies {
          classpath 'com.github.jengelman.gradle.plugins:shadow:1.2.3'
     }
}

apply plugin: 'java'
apply plugin: 'com.github.johnrengelman.shadow'

group = 'com.bugvm'
archivesBaseName = "bugvm-rt"
version = '1.1.20-SNAPSHOT'

description = """BugVM Runtime Library"""

sourceCompatibility = 1.7
targetCompatibility = 1.7
tasks.withType(JavaCompile) {
     options.encoding = 'UTF-8'
}

sourceSets {

     main {
          java {
               srcDirs = ['src', 'libcore', 'external']
          }
     }

     shadowJar {
          relocate 'org.bouncycastle', 'com.android.org.bouncycastle'
          relocate 'org.conscrypt', 'com.android.org.conscrypt'
          relocate 'com.squareup', 'com.android.com.squareup'
     }

}


jar.doFirst{
     manifest {
          attributes("Manifest-Version" : "1.0", "Implementation-Version" : project.version)
     }
}

task jarSources(type:Jar){
     from sourceSets.main.getAllSource()
     classifier = 'source'
}

jar.dependsOn jarSources