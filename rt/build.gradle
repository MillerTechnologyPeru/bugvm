buildscript {
     repositories {
          jcenter()
     }
     dependencies {
          classpath 'com.github.jengelman.gradle.plugins:shadow:1.2.3'
     }
}

apply plugin: 'java'
apply plugin: 'com.github.johnrengelman.shadow'

group = 'com.bugvm'
archivesBaseName = "bugvm-rt"
version = "$bugVMVersion"

description = """BugVM Runtime Library"""

sourceCompatibility = 1.7
targetCompatibility = 1.7
tasks.withType(JavaCompile) {
     options.encoding = 'UTF-8'
}

repositories {
     mavenLocal()
     mavenCentral()
     maven { url 'https://oss.sonatype.org/content/repositories/snapshots' }
}

dependencies {
     compile "commons-io:commons-io:2.4"
}

sourceSets {

     main {
          java {
               srcDirs = ['src', 'libcore', 'external']
          }
     }

     shadowJar {
          relocate 'org.bouncycastle', 'com.android.org.bouncycastle'
          relocate 'org.conscrypt', 'com.android.org.conscrypt'
          relocate 'com.squareup', 'com.android.com.squareup'
     }

}


jar.doFirst{
     manifest {
          attributes "Implementation-Version" : project.version
          attributes 'vm-version': '1.0.0'
     }
}

task jarSources(type:Jar){
     from sourceSets.main.getAllSource()
     classifier = 'source'
}

jar.dependsOn jarSources